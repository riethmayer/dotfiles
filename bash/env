# -*- mode: shell-script -*-

export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8

# shell prompt setup
function __git_ps1()
{
    local b="$(git symbolic-ref HEAD 2>/dev/null)";
    if [ -n "$b" ]; then
        printf " (%s)" "${b##refs/heads/}";
    fi
}
export PS1='\W \u\[\e[01;37m\]:`[[ $(git status 2> /dev/null | tail -n1) != "nothing to commit (working directory clean)" ]] && echo "\[\e[31m\]" || echo "\[\e[32m\]"`$(__git_ps1 "(%s)\[\e[00m\]")\[\e[00m\]\$ '

# EDITOR + terminal setup
export TERM=xterm-256color
export EDITOR="emacs"
export ALTERNATE_EDITOR=""

# Global variables
export GITHUB_LOGIN="riethmayer"
export AWS_ENV="production"
export ORGANIZATION_GITHUB_LOGIN="bonusboxme"

## for linking GH stuff
export GITHUB_PROJECTS_PATH=$HOME/github
mkdir -p $GITHUB_PROJECTS_PATH

## for bonusbox stuff
export PROJECT_BASE=$HOME/bonusbox/projects
mkdir -p $PROJECT_BASE

# PATH setup
## homebrew
export PATH="/usr/local/sbin:$PATH"

## my scripts
[ ! -d $HOME/bin ] && ln -s $DOTFILES_DIR/bin $HOME/bin
export PATH=$HOME/bin:$PATH

# link dotfiles from my project to the root of my machine if they're
# not present. So files always are in place.
for config in tmux.conf gemrc gitconfig; do
    [ ! -f $HOME/.$config ] && ln -s $DOTFILES_DIR/$config $HOME/.$config
done

# me secretz
[ ! -d $HOME/src/secret ] && echo "downloading secret" && pp secret
source $HOME/src/secret/environment.sh

## bonusbox projects
export PATH=$PROJECT_BASE/bb/bin:$PATH
[ -d $PROJECT_BASE/bb ] && eval "$($PROJECT_BASE/bb/bin/bb init -)"

# travis setup
[ -f $HOME/.travis ] && source $HOME/.travis/travis.sh

#AMI_PATH=$PROJECT_BASE/ami_builder
#[ ! -d $AMI_PATH ] && p ami_builder
#export EC2_BONUSBOX_KEY=$AMI_PATH/config/ec2_bonusbox.pem

## ANSIBLE
export PATH=$GITHUB_PROJECTS_PATH/ansible/bin:$PATH
export PYTHONPATH=$GITHUB_PROJECTS_PATH/ansible/lib:$PYTHONPATH
export MANPATH=$GITHUB_PROJECTS_PATH/ansible/docs/man:$MANPATH

## RVM needs to be at the end or it complaints
export PATH="$PATH:$HOME/.rvm/bin"
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm"
